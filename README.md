# Cloverfes Job Manager
このシステムは、学園祭実行委員会の副委員長をしていた際に制作したシステムである。

## 制作背景（課題、目的など）
新規加入スタッフとの面談申請・面談日程調整・進捗管理にかかる業務が、従来は手作業で行われており、膨大な手間がかかっていた。例えば、面談申請が来た際、面談を担当する班のリーダーに対して面談申請の情報を共有するという作業を面談申請1件ごとに手作業で行っていたほか、班のリーダーに面談申請情報を共有したあとに面談日時や面談担当者の情報を集約する人がいなかったため、面談業務全体の進捗状況が不明瞭になっていた。  
これらの業務の負担軽減や、進捗管理ができていない状況の改善のため、業務全体を見直し、効率化システムを構築した。

## 課題に対する解決策
業務連絡ツールとして使用していたDiscordに、Node.jsで動作するBOTを導入した。このBOTは、Googleフォームで送信された面談申請内容をGASが取得し、Node.jsに転送することによって動作し、該当チャンネルへ申請内容を自動通知するという機能を持つ。  
さらに、Discord BOTへのコマンド送信により、面談日時や担当者名をGoogleスプレッドシートに登録できる機能を追加し、面談内容の提出状況の管理や、フォーム未提出者の確認、新規入会から希望班申請までの進捗を一元的に可視化できるようにした。

## システムを導入した結果
面談申請から進捗確認までの業務を自動化し、情報の一元管理と管理担当者の負担軽減に大きく貢献した。  
面談の進捗管理以外の業務に割く時間が増え、システム導入前は週2回であった新入生向けの説明会の頻度を週5回に増やせた。

## 技術選定およびその意図
### 技術選定
Google Apps Script・Node.js・Glitch

### その意図
Googleのサービス（GoogleフォームやGoogleスプレッドシート）をプログラムにより操作するにあたり、Googleのサービスの自動化に関する幅広い機能が揃ったGoogle Apps Scriptを使用することを決定した。  
Discord BOTの開発手段を決定するにあたり、BOTはユーザーからのコマンドを常時受け付けるため、サーバー上で常時動作可能な環境にしたいと考えていたほか、個人開発であるためコストをかけずに運用したいと考えていた。このような条件から、候補としてNode.jsのライブラリ(Discord.js)やPythonのライブラリ(Discord.py)などが挙げられた。検討の結果、無料枠が広く簡易なWebサーバー構築やスクリプト実行に適しているGlitchの使用を決定し、Glitchと相性の良いNode.jsを使用することにした。

## リポジトリ内のファイルに関する説明
### [main.gs](main.gs)
Google Apps Scriptのスクリプト。

### [nodejsフォルダ](nodejs)
Glitchのプロジェクトにアップロードした、Node.jsのファイル群。  
Glitchのプロジェクトは以下のリンク先にある（GitHubにあげたものと同じファイル）。  
https://discord-gas-link-2.glitch.me

### [補足資料.pdf](補足資料.pdf)
スプレッドシートの表示例や、スタッフ向けの説明で使用したスライドを掲載している。
